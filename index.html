<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dulmatesa - Generador de firmas para correo</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

    /* Estilos responsivos */
        @media screen and (max-width: 768px) {
    .container {
        flex-direction: column;
        padding: 10px;
    }

    .form-section,
    .preview-section {
        margin: 0;
        max-width: 100%;
    }

    .form-section input,
    .form-section select,
    .form-section button {
        width: 100%;
    }

    h1 {
        font-size: 28px;
    }

    input, select {
        font-size: 14px;
    }

    .preview-container {
        width: 100%;
        padding: 0;
    }
}

        @media screen and (max-width: 480px) {
    h1 {
        font-size: 24px;
    }

    .form-section input,
    .form-section select,
    .form-section button {
        font-size: 12px;
    }

    input, select {
        padding: 8px;
    }

    .preview-container {
        padding: 5px;
    }

    .copy-button {
        font-size: 14px;
    }
}
      
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f4f4f4;
        }
        .container {
            display: flex;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .form-section {
            font-family: 'Montserrat', sans-serif;
            font-size: 17px;
            flex: 1;
            max-width: 595px;
        }
        .preview-section {
            flex: 1;
            margin-left: 20px;
        }
        .preview-container {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            background-color: transparent; /* Sin color de fondo */
        }
        h1 {
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 39px;
            line-height: 38px;
            color: #133850;
        }
        label {
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-family: 'Montserrat', sans-serif;
            font-size: 15px;
        }
        button {
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: not-allowed;
            display: block;
            width: 100%;
            height: 66px;
            font-family: 'Montserrat', sans-serif;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        button:hover:enabled {
            background-color: #0056b3;
            cursor: pointer;
        }
        .signature {
            margin-top: 1px;
            padding: 1px;
            white-space: pre-wrap;
            background-color: #f9f9f9;
            height: 1px;
            overflow-y: auto;
            box-sizing: border-box;
            width: 100%;
            user-select: none; /* Desactiva la selección de texto por defecto */
        }
        .signature.selectable {
            user-select: text; /* Permite la selección de texto */
        }
        .copy-button {
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-size: 17px;
            width: 100%;
        }
        .copy-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .copy-button:hover:enabled {
            background-color: #218838;
            cursor: pointer;
        }
        .message {
            display: none;
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #28a745;
            background-color: #d4edda;
            color: #155724;
            border-radius: 5px;
            font-family: 'Montserrat', sans-serif;
        }
        .extra-info {
            margin-top: 20px;
        }
        .extra-info a {
            color: #0C96D4;
            text-decoration: none;
            font-weight: bold;
            font-size: 12px; /* Tamaño de letra ajustado */
        }
        .preview-container {
            border: 1px solid #ccc;
            border-radius: 5px;
  
        }
        .extra-info p {
            margin: 10px 0;
            font-size: 11px; /* Tamaño de letra ajustado */
        }

    </style>
  </head>
  <body>
    <div class="container">
      <div class="form-section">
        <h1>Generador de firmas<br>
          Correo Dulmatesa</h1>
        Bienvenid@ al generador de firmas para correo de Dulmatesa. Para generar
        tu firma, selecciona tu nombre y pulsa el botón verde "Copiar firma al
        portapapeles".<br>
        <br>
        Si lo deseas, puedes escribir un saludo que se mostrará automáticamente
        en tus correos, justo encima de tu firma. En caso de que no quieras
        incluir un saludo, simplemente no escribas nada.<br>
        <br>
        Puedes ver una vista previa en tiempo real que te muestra
        cómo quedará tu firma. <br>
        <br>
        <strong style="color:#133850">Por favor, selecciona tu nombre y pulsa el
          botón verde "Copiar firma al portapapeles".<br>
        </strong> <br>
        <form id="signatureForm"> <label for="name" style="color:#133850">Nombre:</label>
          <select id="name" required="" onchange="updateSignature()">
            <option value="" disabled="disabled" selected="selected">Selecciona
              tu nombre</option>
            <option value="Alejandro Silva">Alejandro Silva</option>
            <option value="Ana Gutiérrez">Ana Gutiérrez</option>
            <option value="Alfredo González">Alfredo González</option>
            <option value="Esteban Tirado">Esteban Tirado</option>
            <option value="Pablo Alonso">Pablo Alonso</option>
            <option value="Raúl Castejón">Raúl Castejón</option>
          </select>
          <label for="position" style="display: none;">Cargo:</label> <input id="position"

            placeholder="Tu cargo" required="" oninput="updateSignature()" style="display: none;"

            type="text"> <label for="office" style="display: none;">Sede:</label>
          <select style="display: none;" id="office" required="" onchange="updateSignature()">
            <option style="display: none;" value="" disabled="disabled" selected="selected">Selecciona
              una sede</option>
            <option value="Sede Navarrés">Sede Navarrés</option>
            <option value="Sede Puente Genil">Sede Puente Genil</option>
            <option value="Oficinas Centrales / HQ">Oficinas Centrales / HQ</option>
          </select>
          <label for="phone" style="display: none;">Teléfono:</label> <input id="phone"

            placeholder="Tu teléfono" required="" oninput="updateSignature()" style="display: none;"

            type="number"> <label for="email" style="display: none;">Correo
            electrónico:</label> <input id="email" placeholder="Tu correo electrónico"

            required="" oninput="updateSignature()" style="display: none;" type="email"><span

            id="emailError"></span> <label style="color:#133850" for="saludo"><br>
            Saludo encima de la firma (opcional)</label> <input id="saludo" placeholder="Tu saludo. Si no quieres incluir uno, déjalo vacío."

            required="" oninput="updateSignature()" style="width: 96%;" type="text"><span

            id="emailError"></span> </form>
        <div class="output">
          <div class="signature" id="signatureOutput" style="visibility:hidden"></div>
          <button class="copy-button" id="copyButton" onclick="copyToClipboard()"

            disabled="disabled">Copiar firma al portapapeles</button>
          <div class="message" id="copyMessage"><strong>Firma copiada al
              portapapeles. Ahora pégala en Outlook.</strong></div>
        </div>
      </div>
      <div class="preview-section">
        <div class="preview-container">
          <div class="preview" id="signaturePreview"></div>
        </div>
      </div>
    </div>
    <script>

        // Función para actualizar firma
        function updateSignature() {
            const name = document.getElementById('name').value || 'Nombre';
            const position = document.getElementById('position').value || 'Cargo';
            const office = document.getElementById('office').value || 'Sede';
            const phone = document.getElementById('phone').value || 'Teléfono';
            const email = document.getElementById('email').value || 'Email';
            const saludo = document.getElementById('saludo').value || '';

            // Validación del correo electrónico
            const emailError = document.getElementById('emailError');
            if (email && !validateEmail(email)) {
                emailError.style.display = 'block';
            } else {
                emailError.style.display = 'none';
            }

            // Direcciones según la sede
            let address;
            switch (office) {
                case 'Sede Navarrés':
                    address = 'Partida de la Traviesa s/n, 46823 Navarrés, Valencia';
                    break;
                case 'Sede Puente Genil':
                    address = 'Ctra. Estepa Guadix, Km 12.8 - 14.500 Puente Genil (Córdoba)';
                    break;
                case 'Oficinas Centrales / HQ':               
                    address = 'C/ Jaén, 9. Edificio Galia, 3º Of. 14, Parque Comercial Málaga Nostrum, 29004, Málaga';
                    break;
                default:
                address = 'Sede';
            }
          
           // Cargo según el nombre
           let positionValue;
           let oficina;
           let direccion;
           let telefono;
           let correo;
                    
            // Listado de usuarios
            switch (name) {
                case 'Alejandro Silva':
                    positionValue = 'Responsable de Departamento IT';
                    oficina = 'Oficinas Centrales / HQ';
                    telefono = '636514538';
                    correo = 'alejandro.silva@dulmatesa.es';
                    break;
                case 'Alfredo González':
                    positionValue = 'Director Financiero';
                    oficina = 'Oficinas Centrales / HQ';
                    telefono = '606950021';
                    correo = 'alfredo.gonzalez@dulmatesa.es';
                    break;
                case 'Ana Gutiérrez':
                    positionValue = 'Jefa de Calidad';
                    oficina = 'Sede Puente Genil';
                    telefono = '652914552';
                    correo = 'ana.gutierrez@dulmatesa.es';
                    break;               
                case 'Esteban Tirado':               
                    positionValue = 'Jefe Logística';
                    oficina = 'Sede Navarrés';
                    correo = 'esteban.tirado@dulmatesa.es';
                    telefono = '658877528';
                    break;
                case 'Pablo Alonso':
                    positionValue = 'Director RR.HH.';
                    oficina = 'Oficinas Centrales / HQ';
                    telefono = '660970356';
                    correo = 'pablo.alonso@dulmatesa.es';
                    break;
                case 'Raúl Castejón':               
                    positionValue = 'Controller';
                    oficina = 'Oficinas Centrales / HQ';
                    correo = 'raul.castejon@dulmatesa.es';
                    telefono = '699089050';
                    break;
                default:
                positionValue = 'Cargo';
                oficina = 'Oficina';
                telefono = 'Teléfono';
                correo = 'Correo';
            }
          
          // Dirección según sede
          switch (oficina) {
           case 'Sede Navarrés':
           address = 'Partida de la Traviesa s/n, 46823 Navarrés, Valencia';
           break;
           case 'Sede Puente Genil':
           address = 'Ctra. Estepa Guadix, Km 12.8 - 14.500 Puente Genil (Córdoba)';
           break;
           case 'Oficinas Centrales / HQ':
           address = 'C/ Jaén, 9. Edificio Galia, 3º Of. 14, Parque Comercial Málaga Nostrum, 29004, Málaga';    
           break;
           default:
           address = 'Dirección';
           }

          // Código HTML generado 
          const signatureHTML = `
    <style>
        .blue-text {
            color: #0000ff;
        }

    /* Estilos responsivos */
    @media screen and (max-width: 768px) {
    
    .container {
            display: flex;
            gap: 20px;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 0px rgba(0, 0, 0, 0.1);
        }

    body {
        font-family: 'Montserrat', sans-serif;
        background-color: #ffffff;
    }
    .container {
        flex-direction: column;
        padding: 10px;
    }

    .form-section,
    .preview-section {
        margin: 0;
        max-width: 100%;
        border: 0px;
    }

    .form-section input,
    .form-section select,
    .form-section button {
        width: 100%;
    }

    h1 {
        font-size: 28px;
        line-height: 29px;
    }

    input, select {
        font-size: 14px;
    }

    .preview-container {
        width: 98%;
        padding: 0;
        border: 0px;
    }
}

    @media screen and (max-width: 480px) {
    
    .container {
            display: flex;
            gap: 20px;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 0px rgba(0, 0, 0, 0.1);
        }

    body {
        font-family: 'Montserrat', sans-serif;
        background-color: #ffffff;
    }

    h1 {
        font-size: 25px;
        line-height: 26px;
    }

    .form-section input,
    .form-section select,
    .form-section button {
        font-size: 12px;
    }

    input, select {
        padding: 8px;
    }

    .preview-container {
        width: 98%;
        padding: 5px;
    }

    .copy-button {
        font-size: 14px;
    }
}
    </style>

                <span style="font-family: 'Montserrat', sans-serif;">${saludo}</span>
                <div style="font-family: 'Montserrat', sans-serif; color: #333; width: 595px;">
                <table style="font-family: 'Montserrat', sans-serif; width: 570px;" border="0" cellspacing="0" cellpadding="0";>
                <br>
                    <tr><td><a href="https://www.dulmatesa.es" target="_blank">
                    <img src="https://i.postimg.cc/PJM6gvyZ/Dulmatesa-logo.png" alt="Logo" style="width: 200px; margin-bottom: 20px;">
                    </a></td></tr>

                    <tr><td style="line-height: 13px;"><strong style="font-family: 'Montserrat', sans-serif; font-size: 11pt; color: #133850;">${name}</strong><br></td></tr>
                    <tr><td style="line-height: 12px;"><strong style="font-family: 'Montserrat', sans-serif; font-size: 10pt; color: #133850;">${positionValue}</strong><br></td></tr>
                    <tr><td style="line-height: 20px; font-family: 'Montserrat', sans-serif; font-size: 9pt; color: #133850;">${oficina}</td></tr>
                    </table>

                    <table cellspacing="0" cellpadding="0" border="0">
                    <tr><td cellspacing="0" cellpadding="0" border="0" width="570px" height="10px" style="height: 10px; vertical-align: middle;"></td></tr>
                    </table>

                    
                    <table cellspacing="0" cellpadding="0" border="0">
                    <tr><td cellspacing="0" cellpadding="0" border="0" width="0px" style="padding-right: 10px; vertical-align: middle;">
                        <img src="https://i.postimg.cc/4NSjL4VL/telf-dulma.png" alt="Teléfono" style="display: block;">
                    </td>
                    <td width="545px" height="25px" style="font-family: Montserrat, sans-serif; font-size: 9pt; color: #828282; vertical-align: middle;">
                        <a href="tel:${telefono}" style="font-family: 'Montserrat', sans-serif; color: #828282; font-size: 9pt; text-decoration: none;"><font color="grey">${telefono}</font></a>
                    </td></tr></table>
                    

                    <table cellspacing="0" cellpadding="0" border="0">
                    <tr><td cellspacing="0" cellpadding="0" border="0" width="0px" style="padding-right: 9px; vertical-align: middle;">
                        <img src="https://i.postimg.cc/Kj9CyxVY/mail-dulma.png" alt="Correo" style="display: block;">
                    </td>
                    <td width="545px" height="25px" style="font-family: Montserrat, sans-serif; font-size: 9pt; color: #828282; vertical-align: middle;">
                    <a href="mailto:${correo}" style="font-family: 'Montserrat', sans-serif; color: #828282; font-size: 9pt; text-decoration: none;"><font color="grey">${correo}</font></a>
                    </td></tr></table>


                    <table cellspacing="0" cellpadding="0" border="0">
                    <tr><td width="0px" style="padding-right: 11px; vertical-align: middle;">
                        <img align="absmiddle" src="https://i.postimg.cc/bY7ms6cJ/ubi-dulma.png" alt="Dirección" style="display:block;">
                    </td>
                    <td width="545px" height="25px" style="font-family: Montserrat, sans-serif; font-size: 9pt; color: #828282; vertical-align: middle;">
                        <span style="font-family: 'Montserrat', sans-serif; color: #828282; font-size: 9pt; text-decoration: none;"><font color="grey">${address}</font></span>
                    </td></tr></table>
                    

                    <table cellspacing="0" cellpadding="0" border="0">
                    <tr><td width="0px" style="padding-right: 8px; vertical-align: middle;">
                        <img width=18px src="https://i.postimg.cc/NFJjFyLq/nueva-web.png" alt="Nueva web de Dulmatesa" style="display: block;">
                    </td>
                    <td width="544px" height="25px" style="font-family: Montserrat, sans-serif; font-size: 10pt; color: #0C96D4; vertical-align: middle;">
                        <div class="blue-text"><a href="https://www.dulmatesa.es" style="font-family: 'Montserrat', sans-serif; color: #0C96D4; font-size: 10pt; font-weight: bold; text-decoration: none;"><font color="#0C96D4">Visita nuestra web: www.dulmatesa.es</font></a></div>
                    </td></tr></table>
                    
                    <table width="570px" cellspacing="0" cellpadding="0" border="0">
                    <tr><td width="570px" height="10px">
                    <div style="width:570px; height:2px; border-bottom: 2px solid #0C96D4; margin-top:10px; margin-bottom:5px;"></div>
                    </tr></td></table>
                    
                    
                    <tr><td>
                    <div style="margin-top: 10px;">
                        <img src="https://martacaballero.com/wp-content/uploads/2020/08/lopez-1.png" alt="Productos López" style="width: 100px; margin-right: 10px;">
                        <img src="https://martacaballero.com/wp-content/uploads/2020/08/ProductosLopez.png" alt="Productos López" style="width: 100px;">
                    </div></td></tr>
                        </table> 
                    <div style="margin-top: 15px;">
                        <table style="width: 570px;" border="0">

                                <tr>
                                    <td style="width: 20px;"> <img width="20px" src="https://martacaballero.com/wp-content/uploads/2020/07/reciclado.png" alt="Reciclado" style="vertical-align: middle;"></td>
                                    <td style="width: 570px;"><p style="margin: 10px 0; font-family: 'Montserrat', sans-serif; font-size: 8pt; color: #878787;">Cuidemos el medio ambiente. Por favor no imprima este e-mail si no es necesario.</p></td>
                                </tr> 
                        </table>
                        <table style="width: 570px;" border="0">
                                <tr>
                                    <td style="width: 570px;"><p style="margin: 10px 0; font-family: 'Montserrat', sans-serif; font-size: 8pt; color: #878787;">AVISO LEGAL: En virtud de la Ley Orgánica 3/2018, de 5 de diciembre, de Protección de Datos Personales y garantía de los derechos digitales y del reglamento europeo RGPD 679/2016 le informamos que sus datos están siendo objeto de tratamiento por parte de DULMATESA, S.L. Le informamos que los Datos de Carácter Personal que recoge son objeto de tratamiento, aplicándose los protocolos que la RGPD y la AGENCIA ESPAÑOLA DE PROTECCIÓN DE DATOS obliga. Para ejercitar sus derechos puede dirigirse a DULMATESA, S.L. en el domicilio social de calle Jaén, 9, Edificio Galia, Planta 3, Oficina 14, en el 29004 de Málaga o en el email: <a href="mailto:lopd@dulmatesa.es" style="color: #0C96D4; font-size: 8pt; font-weight: normal;"><font color="#0c96d4">lopd@dulmatesa.es</font></a> con el fin de ejercer sus derechos de acceso, rectificación, supresión (derecho al olvido), limitación de tratamiento, portabilidad de los datos, oposición, y a no ser objeto de decisiones automatizadas, indicando como Asunto: “Derechos Ley Protección de Datos”, y adjuntando fotocopia de su DNI. La información contenida en este correo electrónico, y en su caso en los documentos adjuntos, es información privilegiada para uso exclusivo de la persona y/o personas a las que va dirigido. No está permitido el acceso a este mensaje a cualquier otra persona distinta a los indicados. Si Usted no es uno de los destinatarios, cualquier duplicación, reproducción, distribución, así como cualquier uso de la información contenida en él o cualquiera otra acción u omisión tomada en relación con el mismo, puede estar prohibido y ser ilegal. En dicho caso, por favor notifíquelo al remitente y proceda a la eliminación de este correo electrónico, así como de sus adjuntos si los hubiere.</p></td>
                                </tr>
                        </table>                       
                    </div>
                </div>
            `;

            document.getElementById('signaturePreview').innerHTML = signatureHTML;
            document.getElementById('signatureOutput').innerText = signatureHTML.trim();

            // Habilitar el botón de copiar al portapapeles solo si todos los campos están llenos y válidos
            const allFieldsFilled = Array.from(document.querySelectorAll('#name'))
                .every(field => field.value.trim() !== '');
            if (allFieldsFilled) {
                copyButton.classList.add('enabled');
                copyButton.disabled = false;
                signatureOutput.classList.add('selectable'); // Habilitar selección de texto
            } else {
                copyButton.classList.remove('enabled');
                copyButton.disabled = true;
                signatureOutput.classList.remove('selectable'); // Deshabilitar selección de texto
            }
        }
      
        // Declaración de función para copiar al portapapeles
        function copyToClipboard() {
            window.scrollTo(0, document.body.scrollHeight); // Bajamos abajo del todo
            const signaturePreview = document.getElementById('signaturePreview'); // Selecciona el contenedor de vista previa
            const range = document.createRange(); // Crea un nuevo rango
            range.selectNodeContents(signaturePreview); // Selecciona todo el contenido del contenedor
            const selection = window.getSelection(); // Obtiene la selección actual
            selection.removeAllRanges(); // Limpia cualquier selección previa
            selection.addRange(range); // Añade el rango recién creado a la selección
            document.execCommand('copy'); // Copia el contenido seleccionado al portapapeles
            selection.removeAllRanges(); // Limpia cualquier selección previa

            // Muestra el mensaje de confirmación de copia
            const message = document.getElementById('copyMessage');
            message.style.display = 'block';

            // Oculta el mensaje después de 7 segundos
            setTimeout(() => {
                message.style.display = 'none';
            }, 7000);
        }

        // Validar email
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(String(email).toLowerCase());
        }

        // Actualizar la vista previa en tiempo real
        document.querySelectorAll('#name, #position, #office, #phone, #email').forEach(element => {
            element.addEventListener('input', updateSignature);
        });

        // Actualizar vista previa al cargar la página
        updateSignature();
    </script>
  </body>
</html>
